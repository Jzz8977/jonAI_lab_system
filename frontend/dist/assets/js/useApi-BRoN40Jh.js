var e=Object.defineProperty,r=Object.getOwnPropertySymbols,t=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,s=(r,t,a)=>t in r?e(r,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):r[t]=a,n=(e,r,t)=>new Promise((a,s)=>{var n=e=>{try{l(t.next(e))}catch(r){s(r)}},o=e=>{try{l(t.throw(e))}catch(r){s(r)}},l=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,o);l((t=t.apply(e,r)).next())});import{n as o}from"./index-C7qi9upo.js";import{r as l,c as i}from"./vendor-Gjpba6V1.js";class u{static handleApiError(e,r={}){var t,a,s,n,l,i;const{showToast:u=!0,showNotification:c=!1,customMessage:d,logError:h=!0}=r;let g;if(e.response){const r=e.response;g={message:d||(null==(a=null==(t=r.data)?void 0:t.error)?void 0:a.message)||this.getStatusMessage(r.status),code:(null==(n=null==(s=r.data)?void 0:s.error)?void 0:n.code)||`HTTP_${r.status}`,status:r.status,details:null==(i=null==(l=r.data)?void 0:l.error)?void 0:i.details}}else g=e.request?{message:d||"Network error. Please check your connection.",code:"NETWORK_ERROR",status:0}:{message:d||e.message||"An unexpected error occurred",code:"UNKNOWN_ERROR"};return c?o.notify.error("Error",g.message):u&&o.error(g.message),g}static handleValidationError(e,r={}){const{showToast:t=!0,customMessage:a}=r,s=Object.entries(e).map(([e,r])=>`${e}: ${r.join(", ")}`).join("\n"),n=a||`Validation failed:\n${s}`;t&&o.error(n)}static handleGeneralError(e,r={}){const{showToast:t=!0,showNotification:a=!1,customMessage:s,logError:n=!0}=r,l=s||("string"==typeof e?e:e.message)||"An unexpected error occurred";a?o.notify.error("Error",l):t&&o.error(l)}static getStatusMessage(e){switch(e){case 400:return"Invalid request. Please check your input.";case 401:return"Authentication required. Please log in.";case 403:return"Access denied. You don't have permission for this action.";case 404:return"The requested resource was not found.";case 409:return"Conflict. The resource already exists or is in use.";case 422:return"Invalid data. Please check your input.";case 429:return"Too many requests. Please try again later.";case 500:return"Server error. Please try again later.";case 502:return"Service temporarily unavailable. Please try again later.";case 503:return"Service unavailable. Please try again later.";default:return`Request failed with status ${e}`}}static withErrorHandling(e){return n(this,arguments,function*(e,r={}){try{return yield e()}catch(t){return this.handleApiError(t,r),null}})}static withLoadingAndErrorHandling(e){return n(this,arguments,function*(e,r="Loading...",t={}){const a=o.loading(r);try{const r=yield e();return a.close(),r}catch(s){return a.close(),this.handleApiError(s,t),null}})}}const c=u.handleApiError.bind(u);function d(e,r={}){const{showSuccessMessage:t=!1,showErrorMessage:a=!0,successMessage:s="Operation completed successfully",loadingMessage:u,immediate:d=!1,resetOnExecute:h=!0}=r,g=l(!1),v=l(null),y=l(null),f=l(!1),p=i(()=>!g.value&&!f.value),m=i(()=>!g.value&&f.value&&!v.value&&null!==y.value),E=i(()=>!g.value&&f.value&&null!==v.value),w=(...r)=>n(this,null,function*(){try{g.value=!0,h&&(v.value=null);let a=null;u&&(a=o.loading(u));const n=yield e(...r);return y.value=n,f.value=!0,a&&a.close(),t&&o.success(s),n}catch(n){f.value=!0;const e=c(n,{showToast:a,logError:!0});return v.value=e,null}finally{g.value=!1}});return d&&w(),{loading:g,error:v,data:y,hasExecuted:f,isIdle:p,isSuccess:m,isError:E,execute:w,retry:(...e)=>n(this,null,function*(){return w(...e)}),reset:()=>{g.value=!1,v.value=null,y.value=null,f.value=!1}}}function h(e,n={}){const{execute:o,loading:l,error:i,data:u,reset:c,retry:h,isSuccess:g,isError:v,isIdle:y}=d(e,((e,n)=>{for(var o in n||(n={}))t.call(n,o)&&s(e,o,n[o]);if(r)for(var o of r(n))a.call(n,o)&&s(e,o,n[o]);return e})({immediate:!0,showErrorMessage:!0},n));return{data:u,loading:l,error:i,isIdle:y,isSuccess:g,isError:v,refresh:()=>o(),retry:h,reset:c}}function g(e,r=1,t=20){const a=l(r),s=l(t),o=l([]),i=l({}),{loading:u,error:c,execute:h,isSuccess:g}=d((...r)=>n(this,null,function*(){const t=yield e(a.value,s.value,...r);return o.value=t.data,i.value=t.pagination,t}),{showErrorMessage:!0});return{items:o,pagination:i,loading:u,error:c,isSuccess:g,page:a,limit:s,loadPage:(e,...r)=>n(this,null,function*(){return a.value=e,h(...r)}),changePageSize:(e,...r)=>n(this,null,function*(){return s.value=e,a.value=1,h(...r)}),refresh:(...e)=>h(...e)}}u.handleValidationError.bind(u),u.handleGeneralError.bind(u),u.withErrorHandling.bind(u),u.withLoadingAndErrorHandling.bind(u);export{g as a,h as u};
