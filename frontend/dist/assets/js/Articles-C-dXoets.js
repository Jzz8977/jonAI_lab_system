var e=Object.defineProperty,l=Object.defineProperties,a=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(l,a,t)=>a in l?e(l,a,{enumerable:!0,configurable:!0,writable:!0,value:t}):l[a]=t,d=(e,l,a)=>new Promise((t,i)=>{var s=e=>{try{d(a.next(e))}catch(l){i(l)}},r=e=>{try{d(a.throw(e))}catch(l){i(l)}},d=e=>e.done?t(e.value):Promise.resolve(e.value).then(s,r);d((a=a.apply(e,l)).next())});import{x as u,aB as n,r as o,X as c,c as p,j as f,al as _,ar as m,y as h,z as v,A as b,K as g,Q as y,I as C,M as w,u as k,P as A,a6 as S,H as z,J as V,O as D}from"./vendor-Gjpba6V1.js";import{n as j,c as P,b as O}from"./index-C7qi9upo.js";import{a as U}from"./useApi-BRoN40Jh.js";import{q as x,D as $,v as T,r as F,p as B,k as E,F as L}from"./ui-BjnOHbRg.js";import{a as I}from"./articles-CAehjcUo.js";import{c as M}from"./categories-Z7P03ef2.js";import"./utils-C5DcNM9U.js";const H={class:"articles"},q={class:"articles-header"},J={class:"header-actions"},K={class:"filters-section"},N={key:0,class:"bulk-actions"},Q={class:"bulk-buttons"},R={class:"articles-table"},X={class:"article-title"},G={class:"article-meta"},W={class:"article-stats"},Y={class:"article-actions"},Z={class:"pagination-section"},ee={key:0,class:"article-preview"},le={class:"preview-meta"},ae={key:0,class:"preview-thumbnail"},te=["src"],ie={class:"preview-content"},se=["innerHTML"],re=u({__name:"Articles",setup(e){const u=n(),re=o([]),de=o([]),ue=c({search:"",status:void 0,category_id:void 0,page:1,limit:20,orderBy:"created_at",orderDir:"DESC"}),{items:ne,pagination:oe,loading:ce,refresh:pe}=U((e,u)=>d(this,null,function*(){const d=yield I.getArticles((n=((e,l)=>{for(var a in l||(l={}))i.call(l,a)&&r(e,a,l[a]);if(t)for(var a of t(l))s.call(l,a)&&r(e,a,l[a]);return e})({},ue),o={page:e,limit:u},l(n,a(o))));var n,o;return{data:d.articles,pagination:d.pagination}}),1,20),fe=c({visible:!1,article:null}),_e=p(()=>{let e;return()=>{clearTimeout(e),e=setTimeout(()=>{pe()},500)}}),me=()=>d(this,null,function*(){try{const e=yield M.getCategories();re.value=e.categories}catch(e){j.error("Failed to load categories")}}),he=()=>{Object.assign(ue,{search:"",status:void 0,category_id:void 0,page:1,limit:20,orderBy:"created_at",orderDir:"DESC"}),pe()},ve=e=>{de.value=e},be=()=>{de.value=[]},ge=e=>d(this,null,function*(){if(yield P(`Set as ${e}`,de.value.length))try{const l=de.value.map(e=>e.id);yield I.bulkUpdateStatus(l,e),j.success(`Successfully updated ${l.length} article(s)`),be(),pe()}catch(l){j.error(l.message||"Failed to update articles")}}),ye=()=>d(this,null,function*(){if(yield O(void 0,`Are you sure you want to delete ${de.value.length} article(s)? This action cannot be undone.`))try{const e=de.value.map(e=>e.id);yield I.bulkDelete(e),j.success(`Successfully deleted ${e.length} article(s)`),be(),pe()}catch(e){j.error(e.message||"Failed to delete articles")}}),Ce=(e,l)=>d(this,null,function*(){try{switch(e){case"published":yield I.publishArticle(l.id);break;case"archived":yield I.archiveArticle(l.id);break;default:yield I.updateArticle(l.id,{status:e})}j.success(`Article ${e} successfully`),pe()}catch(a){j.error(a.message||`Failed to ${e} article`)}}),we=e=>{u.push(`/articles/edit/${e.id}`)},ke=e=>{fe.article=e,fe.visible=!0},Ae=e=>d(this,null,function*(){if(yield O(e.title))try{yield I.deleteArticle(e.id),j.success("Article deleted successfully"),pe()}catch(l){j.error(l.message||"Failed to delete article")}}),Se=e=>{switch(e){case"published":return"success";case"draft":return"warning";case"archived":return"info";default:return""}},ze=e=>new Date(e).toLocaleDateString();return f(()=>{pe(),me()}),(e,l)=>{var a;const t=_("el-icon"),i=_("el-button"),s=_("el-input"),r=_("el-col"),d=_("el-option"),u=_("el-select"),n=_("el-row"),o=_("el-alert"),c=_("el-table-column"),p=_("el-link"),f=_("el-tag"),j=_("el-dropdown-item"),P=_("el-dropdown-menu"),O=_("el-dropdown"),U=_("el-table"),I=_("el-pagination"),M=_("el-descriptions-item"),me=_("el-descriptions"),Ve=_("el-dialog"),De=m("loading");return v(),h("div",H,[b("div",q,[l[15]||(l[15]=b("h1",null,"Article Management",-1)),b("div",J,[y(i,{type:"primary",onClick:l[0]||(l[0]=l=>e.$router.push("/articles/create"))},{default:C(()=>[y(t,null,{default:C(()=>[y(k(x))]),_:1}),l[14]||(l[14]=w(" Create Article ",-1))]),_:1,__:[14]})])]),b("div",K,[y(n,{gutter:16},{default:C(()=>[y(r,{span:6},{default:C(()=>[y(s,{modelValue:ue.search,"onUpdate:modelValue":l[1]||(l[1]=e=>ue.search=e),placeholder:"Search articles...",clearable:"",onInput:_e.value},{prefix:C(()=>[y(t,null,{default:C(()=>[y(k($))]),_:1})]),_:1},8,["modelValue","onInput"])]),_:1}),y(r,{span:4},{default:C(()=>[y(u,{modelValue:ue.status,"onUpdate:modelValue":l[2]||(l[2]=e=>ue.status=e),placeholder:"All Status",clearable:"",onChange:k(pe)},{default:C(()=>[y(d,{label:"Draft",value:"draft"}),y(d,{label:"Published",value:"published"}),y(d,{label:"Archived",value:"archived"})]),_:1},8,["modelValue","onChange"])]),_:1}),y(r,{span:4},{default:C(()=>[y(u,{modelValue:ue.category_id,"onUpdate:modelValue":l[3]||(l[3]=e=>ue.category_id=e),placeholder:"All Categories",clearable:"",onChange:k(pe)},{default:C(()=>[(v(!0),h(A,null,S(re.value,e=>(v(),z(d,{key:e.id,label:e.name,value:e.id},null,8,["label","value"]))),128))]),_:1},8,["modelValue","onChange"])]),_:1}),y(r,{span:4},{default:C(()=>[y(u,{modelValue:ue.orderBy,"onUpdate:modelValue":l[4]||(l[4]=e=>ue.orderBy=e),onChange:k(pe)},{default:C(()=>[y(d,{label:"Created Date",value:"created_at"}),y(d,{label:"Updated Date",value:"updated_at"}),y(d,{label:"Title",value:"title"}),y(d,{label:"Views",value:"view_count"}),y(d,{label:"Likes",value:"like_count"})]),_:1},8,["modelValue","onChange"])]),_:1}),y(r,{span:3},{default:C(()=>[y(u,{modelValue:ue.orderDir,"onUpdate:modelValue":l[5]||(l[5]=e=>ue.orderDir=e),onChange:k(pe)},{default:C(()=>[y(d,{label:"Descending",value:"DESC"}),y(d,{label:"Ascending",value:"ASC"})]),_:1},8,["modelValue","onChange"])]),_:1}),y(r,{span:3},{default:C(()=>[y(i,{onClick:he},{default:C(()=>l[16]||(l[16]=[w("Reset",-1)])),_:1,__:[16]})]),_:1})]),_:1})]),de.value.length>0?(v(),h("div",N,[y(o,{title:`${de.value.length} article(s) selected`,type:"info","show-icon":"",closable:!1},{default:C(()=>[b("div",Q,[y(i,{size:"small",onClick:l[6]||(l[6]=e=>ge("draft"))},{default:C(()=>l[17]||(l[17]=[w(" Set as Draft ",-1)])),_:1,__:[17]}),y(i,{size:"small",onClick:l[7]||(l[7]=e=>ge("published"))},{default:C(()=>l[18]||(l[18]=[w(" Publish ",-1)])),_:1,__:[18]}),y(i,{size:"small",onClick:l[8]||(l[8]=e=>ge("archived"))},{default:C(()=>l[19]||(l[19]=[w(" Archive ",-1)])),_:1,__:[19]}),y(i,{size:"small",type:"danger",onClick:ye},{default:C(()=>l[20]||(l[20]=[w(" Delete ",-1)])),_:1,__:[20]}),y(i,{size:"small",onClick:be},{default:C(()=>l[21]||(l[21]=[w(" Clear Selection ",-1)])),_:1,__:[21]})])]),_:1},8,["title"])])):g("",!0),b("div",R,[V((v(),z(U,{data:k(ne),onSelectionChange:ve,"empty-text":"No articles found"},{default:C(()=>[y(c,{type:"selection",width:"55"}),y(c,{label:"Title","min-width":"200"},{default:C(({row:e})=>[b("div",X,[y(p,{onClick:l=>ke(e),type:"primary"},{default:C(()=>[w(D(e.title),1)]),_:2},1032,["onClick"]),b("div",G,[y(f,{size:"small"},{default:C(()=>[w(D(e.slug),1)]),_:2},1024)])])]),_:1}),y(c,{label:"Category",width:"120"},{default:C(({row:e})=>[y(f,{type:"info",size:"small"},{default:C(()=>[w(D(e.category.name),1)]),_:2},1024)]),_:1}),y(c,{label:"Status",width:"100"},{default:C(({row:e})=>[y(f,{type:Se(e.status),size:"small"},{default:C(()=>[w(D(e.status),1)]),_:2},1032,["type"])]),_:1}),y(c,{label:"Author",width:"120"},{default:C(({row:e})=>[w(D(e.author.username),1)]),_:1}),y(c,{label:"Stats",width:"100"},{default:C(({row:e})=>[b("div",W,[b("span",null,[y(t,null,{default:C(()=>[y(k(T))]),_:1}),w(" "+D(e.view_count),1)]),b("span",null,[y(t,null,{default:C(()=>[y(k(F))]),_:1}),w(" "+D(e.like_count),1)])])]),_:1}),y(c,{label:"Created",width:"120"},{default:C(({row:e})=>[w(D(ze(e.created_at)),1)]),_:1}),y(c,{label:"Actions",width:"200",fixed:"right"},{default:C(({row:e})=>[b("div",Y,[y(i,{size:"small",onClick:l=>we(e)},{default:C(()=>[y(t,null,{default:C(()=>[y(k(B))]),_:1})]),_:2},1032,["onClick"]),y(i,{size:"small",onClick:l=>ke(e)},{default:C(()=>[y(t,null,{default:C(()=>[y(k(T))]),_:1})]),_:2},1032,["onClick"]),y(O,{onCommand:l=>Ce(l,e)},{dropdown:C(()=>[y(P,null,{default:C(()=>[y(j,{command:"draft",disabled:"draft"===e.status},{default:C(()=>l[23]||(l[23]=[w(" Set as Draft ",-1)])),_:2,__:[23]},1032,["disabled"]),y(j,{command:"published",disabled:"published"===e.status},{default:C(()=>l[24]||(l[24]=[w(" Publish ",-1)])),_:2,__:[24]},1032,["disabled"]),y(j,{command:"archived",disabled:"archived"===e.status},{default:C(()=>l[25]||(l[25]=[w(" Archive ",-1)])),_:2,__:[25]},1032,["disabled"])]),_:2},1024)]),default:C(()=>[y(i,{size:"small"},{default:C(()=>[l[22]||(l[22]=w(" Status ",-1)),y(t,null,{default:C(()=>[y(k(E))]),_:1})]),_:1,__:[22]})]),_:2},1032,["onCommand"]),y(i,{size:"small",type:"danger",onClick:l=>Ae(e)},{default:C(()=>[y(t,null,{default:C(()=>[y(k(L))]),_:1})]),_:2},1032,["onClick"])])]),_:1})]),_:1},8,["data"])),[[De,k(ce)]])]),b("div",Z,[y(I,{"current-page":ue.page,"onUpdate:currentPage":l[9]||(l[9]=e=>ue.page=e),"page-size":ue.limit,"onUpdate:pageSize":l[10]||(l[10]=e=>ue.limit=e),"page-sizes":[10,20,50,100],total:k(oe).totalCount,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:k(pe),onCurrentChange:k(pe)},null,8,["current-page","page-size","total","onSizeChange","onCurrentChange"])]),y(Ve,{modelValue:fe.visible,"onUpdate:modelValue":l[13]||(l[13]=e=>fe.visible=e),title:null==(a=fe.article)?void 0:a.title,width:"80%",top:"5vh"},{footer:C(()=>[y(i,{onClick:l[11]||(l[11]=e=>fe.visible=!1)},{default:C(()=>l[27]||(l[27]=[w("Close",-1)])),_:1,__:[27]}),y(i,{type:"primary",onClick:l[12]||(l[12]=e=>we(fe.article))},{default:C(()=>l[28]||(l[28]=[w(" Edit Article ",-1)])),_:1,__:[28]})]),default:C(()=>[fe.article?(v(),h("div",ee,[b("div",le,[y(me,{column:2,border:""},{default:C(()=>[y(M,{label:"Status"},{default:C(()=>[y(f,{type:Se(fe.article.status)},{default:C(()=>[w(D(fe.article.status),1)]),_:1},8,["type"])]),_:1}),y(M,{label:"Category"},{default:C(()=>[w(D(fe.article.category.name),1)]),_:1}),y(M,{label:"Author"},{default:C(()=>[w(D(fe.article.author.username),1)]),_:1}),y(M,{label:"Created"},{default:C(()=>[w(D(ze(fe.article.created_at)),1)]),_:1}),y(M,{label:"Views"},{default:C(()=>[w(D(fe.article.view_count),1)]),_:1}),y(M,{label:"Likes"},{default:C(()=>[w(D(fe.article.like_count),1)]),_:1})]),_:1})]),fe.article.thumbnail_url?(v(),h("div",ae,[b("img",{src:fe.article.thumbnail_url,alt:"Article thumbnail"},null,8,te)])):g("",!0),b("div",ie,[l[26]||(l[26]=b("h3",null,"Content:",-1)),b("div",{innerHTML:fe.article.content},null,8,se)])])):g("",!0)]),_:1},8,["modelValue","title"])])}}});export{re as default};
