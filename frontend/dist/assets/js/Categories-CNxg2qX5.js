var e=(e,a,t)=>new Promise((l,r)=>{var o=e=>{try{i(t.next(e))}catch(a){r(a)}},s=e=>{try{i(t.throw(e))}catch(a){r(a)}},i=e=>e.done?l(e.value):Promise.resolve(e.value).then(o,s);i((t=t.apply(e,a)).next())});import{b as a,n as t}from"./index-C7qi9upo.js";import{u as l}from"./useApi-BRoN40Jh.js";import{E as r,q as o,D as s,N as i,p as n,F as c,z as d}from"./ui-BjnOHbRg.js";import{c as u}from"./categories-Z7P03ef2.js";import{x as m,r as p,X as g,c as y,w as v,al as f,H as h,z as _,I as C,Q as b,V as w,A as x,M as k,O as V,n as D,y as S,u as j,K as L}from"./vendor-Gjpba6V1.js";import{_ as N}from"./_plugin-vue_export-helper-BCo6x5W8.js";import"./utils-C5DcNM9U.js";const U={class:"dialog-footer"},z=N(m({__name:"CategoryForm",props:{visible:{type:Boolean},category:{}},emits:["close","success"],setup(a,{emit:t}){const l=a,o=t,s=p(),i=p(!1),n=g({name:"",description:"",slug:""}),c={name:[{required:!0,message:"Category name is required",trigger:"blur"},{min:2,max:100,message:"Name must be between 2 and 100 characters",trigger:"blur"}],description:[{max:500,message:"Description cannot exceed 500 characters",trigger:"blur"}],slug:[{max:100,message:"Slug cannot exceed 100 characters",trigger:"blur"},{pattern:/^[a-z0-9-]*$/,message:"Slug can only contain lowercase letters, numbers, and hyphens",trigger:"blur"}]},d=y(()=>!!l.category),m=()=>{n.name="",n.description="",n.slug="",D(()=>{var e;null==(e=s.value)||e.clearValidate()})};v(()=>l.category,e=>{e?(n.name=e.name,n.description=e.description||"",n.slug=e.slug):m()},{immediate:!0}),v(()=>l.visible,e=>{e&&!l.category&&m()});const S=()=>{o("close")},j=()=>e(this,null,function*(){if(s.value)try{if(!(yield s.value.validate()))return;let e;i.value=!0,d.value&&l.category?(e=yield u.updateCategory(l.category.id,n),r.success("Category updated successfully")):(e=yield u.createCategory(n),r.success("Category created successfully")),o("success",e),S()}catch(e){r.error(e.message||"Failed to save category")}finally{i.value=!1}});return(e,a)=>{const t=f("el-input"),l=f("el-form-item"),r=f("el-form"),o=f("el-button"),u=f("el-dialog");return _(),h(u,{"model-value":e.visible,title:d.value?"Edit Category":"Create Category",width:"500px",onClose:S},{footer:C(()=>[x("div",U,[b(o,{onClick:S},{default:C(()=>a[4]||(a[4]=[k("Cancel",-1)])),_:1,__:[4]}),b(o,{type:"primary",loading:i.value,onClick:j},{default:C(()=>[k(V(d.value?"Update":"Create"),1)]),_:1},8,["loading"])])]),default:C(()=>[b(r,{ref_key:"formRef",ref:s,model:n,rules:c,"label-width":"120px",onSubmit:w(j,["prevent"])},{default:C(()=>[b(l,{label:"Name",prop:"name"},{default:C(()=>[b(t,{modelValue:n.name,"onUpdate:modelValue":a[0]||(a[0]=e=>n.name=e),placeholder:"Enter category name",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),b(l,{label:"Description",prop:"description"},{default:C(()=>[b(t,{modelValue:n.description,"onUpdate:modelValue":a[1]||(a[1]=e=>n.description=e),type:"textarea",placeholder:"Enter category description (optional)",rows:3,maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),b(l,{label:"Slug",prop:"slug"},{default:C(()=>[b(t,{modelValue:n.slug,"onUpdate:modelValue":a[2]||(a[2]=e=>n.slug=e),placeholder:"URL slug (auto-generated if empty)",maxlength:"100","show-word-limit":""},null,8,["modelValue"]),a[3]||(a[3]=x("div",{class:"form-help"}," Leave empty to auto-generate from name ",-1))]),_:1,__:[3]})]),_:1},8,["model"])]),_:1},8,["model-value","title"])}}}),[["__scopeId","data-v-31925340"]]),E={class:"categories"},I={class:"page-header"},A={class:"header-actions"},F={class:"content-card"},M={class:"table-toolbar"},q={class:"toolbar-left"},R={class:"toolbar-right"},B={class:"category-name"},P={class:"category-slug"},G={key:0,class:"description-text"},H={key:1,class:"no-description"},K={class:"action-buttons"},O={key:0,class:"empty-state"},Q={class:"empty-content"},X={key:0},$={key:1},J=N(m({__name:"Categories",setup(r){const m=p(""),g=p(!1),v=p(null),{data:w,loading:D,refresh:N}=l(()=>u.getCategories({orderBy:"name",orderDir:"ASC"}),{showErrorMessage:!0}),U=y(()=>{var e;return(null==(e=w.value)?void 0:e.categories)||[]}),J=y(()=>{if(!m.value)return U.value;const e=m.value.toLowerCase();return U.value.filter(a=>a.name.toLowerCase().includes(e)||a.slug.toLowerCase().includes(e)||a.description&&a.description.toLowerCase().includes(e))}),T=()=>{},W=()=>{v.value=null,g.value=!0},Y=l=>e(this,null,function*(){var e;if(yield a(l.name))try{yield u.deleteCategory(l.id),t.success("Category deleted successfully"),yield N()}catch(r){(null==(e=r.message)?void 0:e.includes("associated articles"))?t.error("Cannot delete category that has associated articles"):t.error("Failed to delete category")}}),Z=()=>{g.value=!1,v.value=null},ee=a=>e(this,null,function*(){yield N()});return(e,a)=>{const t=f("el-button"),l=f("el-input"),r=f("el-table-column"),u=f("el-table"),p=f("el-icon");return _(),S("div",E,[x("div",I,[a[2]||(a[2]=x("div",{class:"header-content"},[x("h1",null,"Category Management"),x("p",null,"Manage article categories and types")],-1)),x("div",A,[b(t,{type:"primary",icon:j(o),onClick:W},{default:C(()=>a[1]||(a[1]=[k(" Create Category ",-1)])),_:1,__:[1]},8,["icon"])])]),x("div",F,[x("div",M,[x("div",q,[b(l,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=e=>m.value=e),placeholder:"Search categories...","prefix-icon":j(s),style:{width:"300px"},clearable:"",onInput:T},null,8,["modelValue","prefix-icon"])]),x("div",R,[b(t,{icon:j(i),onClick:j(N),loading:j(D)},{default:C(()=>a[3]||(a[3]=[k(" Refresh ",-1)])),_:1,__:[3]},8,["icon","onClick","loading"])])]),b(u,{data:J.value,loading:j(D),stripe:"",style:{width:"100%"}},{default:C(()=>[b(r,{prop:"id",label:"ID",width:"80"}),b(r,{prop:"name",label:"Name","min-width":"150"},{default:C(({row:e})=>[x("div",B,[x("strong",null,V(e.name),1),x("div",P,V(e.slug),1)])]),_:1}),b(r,{prop:"description",label:"Description","min-width":"200"},{default:C(({row:e})=>[e.description?(_(),S("span",G,V(e.description),1)):(_(),S("span",H,"No description"))]),_:1}),b(r,{prop:"created_at",label:"Created",width:"160"},{default:C(({row:e})=>{return[k(V((a=e.created_at,new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}))),1)];var a}),_:1}),b(r,{label:"Actions",width:"150",fixed:"right"},{default:C(({row:e})=>[x("div",K,[b(t,{type:"primary",size:"small",icon:j(n),onClick:a=>{return t=e,v.value=t,void(g.value=!0);var t}},{default:C(()=>a[4]||(a[4]=[k(" Edit ",-1)])),_:2,__:[4]},1032,["icon","onClick"]),b(t,{type:"danger",size:"small",icon:j(c),onClick:a=>Y(e)},{default:C(()=>a[5]||(a[5]=[k(" Delete ",-1)])),_:2,__:[5]},1032,["icon","onClick"])])]),_:1})]),_:1},8,["data","loading"]),j(D)||0!==J.value.length?L("",!0):(_(),S("div",O,[x("div",Q,[b(p,{size:"48",color:"#c0c4cc"},{default:C(()=>[b(j(d))]),_:1}),a[7]||(a[7]=x("h3",null,"No categories found",-1)),m.value?(_(),S("p",X," No categories match your search criteria. ")):(_(),S("p",$," Get started by creating your first category. ")),m.value?L("",!0):(_(),h(t,{key:2,type:"primary",icon:j(o),onClick:W},{default:C(()=>a[6]||(a[6]=[k(" Create Category ",-1)])),_:1,__:[6]},8,["icon"]))])]))]),b(z,{visible:g.value,category:v.value,onClose:Z,onSuccess:ee},null,8,["visible","category"])])}}}),[["__scopeId","data-v-9978488f"]]);export{J as default};
