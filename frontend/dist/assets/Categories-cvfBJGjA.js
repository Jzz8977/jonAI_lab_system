import{d as T,r as h,_ as G,c as q,H as U,i as z,w as o,e as m,b as t,s as r,k as H,q as y,t as E,E as C,h as f,V as Q,o as J,a as w,m as v,$,j as M,a0 as K,af as O,a1 as P,a2 as W,T as X,F as Y}from"./index-CNoniGB4.js";import{c as N}from"./categories-BQXbkIAO.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const Z={class:"dialog-footer"},ee=T({__name:"CategoryForm",props:{visible:{type:Boolean},category:{}},emits:["close","success"],setup(L,{emit:x}){const i=L,p=x,g=h(),_=h(!1),l=G({name:"",description:"",slug:""}),b={name:[{required:!0,message:"Category name is required",trigger:"blur"},{min:2,max:100,message:"Name must be between 2 and 100 characters",trigger:"blur"}],description:[{max:500,message:"Description cannot exceed 500 characters",trigger:"blur"}],slug:[{max:100,message:"Slug cannot exceed 100 characters",trigger:"blur"},{pattern:/^[a-z0-9-]*$/,message:"Slug can only contain lowercase letters, numbers, and hyphens",trigger:"blur"}]},k=q(()=>!!i.category),V=()=>{l.name="",l.description="",l.slug="",Q(()=>{var s;(s=g.value)==null||s.clearValidate()})};U(()=>i.category,s=>{s?(l.name=s.name,l.description=s.description||"",l.slug=s.slug):V()},{immediate:!0}),U(()=>i.visible,s=>{s&&!i.category&&V()});const D=()=>{p("close")},B=async()=>{if(g.value)try{if(!await g.value.validate())return;_.value=!0;let n;k.value&&i.category?(n=await N.updateCategory(i.category.id,l),C.success("Category updated successfully")):(n=await N.createCategory(l),C.success("Category created successfully")),p("success",n),D()}catch(s){console.error("Error saving category:",s),C.error(s.message||"Failed to save category")}finally{_.value=!1}};return(s,n)=>{const S=m("el-input"),a=m("el-form-item"),e=m("el-form"),c=m("el-button"),F=m("el-dialog");return f(),z(F,{"model-value":s.visible,title:k.value?"Edit Category":"Create Category",width:"500px",onClose:D},{footer:o(()=>[r("div",Z,[t(c,{onClick:D},{default:o(()=>n[4]||(n[4]=[y("Cancel",-1)])),_:1,__:[4]}),t(c,{type:"primary",loading:_.value,onClick:B},{default:o(()=>[y(E(k.value?"Update":"Create"),1)]),_:1},8,["loading"])])]),default:o(()=>[t(e,{ref_key:"formRef",ref:g,model:l,rules:b,"label-width":"120px",onSubmit:H(B,["prevent"])},{default:o(()=>[t(a,{label:"Name",prop:"name"},{default:o(()=>[t(S,{modelValue:l.name,"onUpdate:modelValue":n[0]||(n[0]=u=>l.name=u),placeholder:"Enter category name",maxlength:"100","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(a,{label:"Description",prop:"description"},{default:o(()=>[t(S,{modelValue:l.description,"onUpdate:modelValue":n[1]||(n[1]=u=>l.description=u),type:"textarea",placeholder:"Enter category description (optional)",rows:3,maxlength:"500","show-word-limit":""},null,8,["modelValue"])]),_:1}),t(a,{label:"Slug",prop:"slug"},{default:o(()=>[t(S,{modelValue:l.slug,"onUpdate:modelValue":n[2]||(n[2]=u=>l.slug=u),placeholder:"URL slug (auto-generated if empty)",maxlength:"100","show-word-limit":""},null,8,["modelValue"]),n[3]||(n[3]=r("div",{class:"form-help"}," Leave empty to auto-generate from name ",-1))]),_:1,__:[3]})]),_:1},8,["model"])]),_:1},8,["model-value","title"])}}}),te=I(ee,[["__scopeId","data-v-31925340"]]),ae={class:"categories"},oe={class:"page-header"},le={class:"header-actions"},se={class:"content-card"},re={class:"table-toolbar"},ne={class:"toolbar-left"},ie={class:"toolbar-right"},ce={class:"category-name"},de={class:"category-slug"},ue={key:0,class:"description-text"},me={key:1,class:"no-description"},pe={class:"action-buttons"},ge={key:0,class:"empty-state"},_e={class:"empty-content"},fe={key:0},ye={key:1},ve=T({__name:"Categories",setup(L){const x=h([]),i=h(!1),p=h(""),g=h(!1),_=h(null),l=q(()=>{if(!p.value)return x.value;const a=p.value.toLowerCase();return x.value.filter(e=>e.name.toLowerCase().includes(a)||e.slug.toLowerCase().includes(a)||e.description&&e.description.toLowerCase().includes(a))}),b=async()=>{try{i.value=!0;const a=await N.getCategories({orderBy:"name",orderDir:"ASC"});x.value=a.categories}catch(a){console.error("Error loading categories:",a),C.error("Failed to load categories")}finally{i.value=!1}},k=()=>{},V=()=>{_.value=null,g.value=!0},D=a=>{_.value=a,g.value=!0},B=async a=>{var e;try{await Y.confirm(`Are you sure you want to delete the category "${a.name}"? This action cannot be undone.`,"Confirm Delete",{confirmButtonText:"Delete",cancelButtonText:"Cancel",type:"warning",confirmButtonClass:"el-button--danger"}),i.value=!0,await N.deleteCategory(a.id),C.success("Category deleted successfully"),await b()}catch(c){if(c==="cancel")return;console.error("Error deleting category:",c),(e=c.message)!=null&&e.includes("associated articles")?C.error("Cannot delete category that has associated articles"):C.error("Failed to delete category")}finally{i.value=!1}},s=()=>{g.value=!1,_.value=null},n=async a=>{await b()},S=a=>new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"});return J(()=>{b()}),(a,e)=>{const c=m("el-button"),F=m("el-input"),u=m("el-table-column"),R=m("el-table"),A=m("el-icon");return f(),w("div",ae,[r("div",oe,[e[2]||(e[2]=r("div",{class:"header-content"},[r("h1",null,"Category Management"),r("p",null,"Manage article categories and types")],-1)),r("div",le,[t(c,{type:"primary",icon:v($),onClick:V},{default:o(()=>e[1]||(e[1]=[y(" Create Category ",-1)])),_:1,__:[1]},8,["icon"])])]),r("div",se,[r("div",re,[r("div",ne,[t(F,{modelValue:p.value,"onUpdate:modelValue":e[0]||(e[0]=d=>p.value=d),placeholder:"Search categories...","prefix-icon":v(K),style:{width:"300px"},clearable:"",onInput:k},null,8,["modelValue","prefix-icon"])]),r("div",ie,[t(c,{icon:v(O),onClick:b,loading:i.value},{default:o(()=>e[3]||(e[3]=[y(" Refresh ",-1)])),_:1,__:[3]},8,["icon","loading"])])]),t(R,{data:l.value,loading:i.value,stripe:"",style:{width:"100%"}},{default:o(()=>[t(u,{prop:"id",label:"ID",width:"80"}),t(u,{prop:"name",label:"Name","min-width":"150"},{default:o(({row:d})=>[r("div",ce,[r("strong",null,E(d.name),1),r("div",de,E(d.slug),1)])]),_:1}),t(u,{prop:"description",label:"Description","min-width":"200"},{default:o(({row:d})=>[d.description?(f(),w("span",ue,E(d.description),1)):(f(),w("span",me,"No description"))]),_:1}),t(u,{prop:"created_at",label:"Created",width:"160"},{default:o(({row:d})=>[y(E(S(d.created_at)),1)]),_:1}),t(u,{label:"Actions",width:"150",fixed:"right"},{default:o(({row:d})=>[r("div",pe,[t(c,{type:"primary",size:"small",icon:v(P),onClick:j=>D(d)},{default:o(()=>e[4]||(e[4]=[y(" Edit ",-1)])),_:2,__:[4]},1032,["icon","onClick"]),t(c,{type:"danger",size:"small",icon:v(W),onClick:j=>B(d)},{default:o(()=>e[5]||(e[5]=[y(" Delete ",-1)])),_:2,__:[5]},1032,["icon","onClick"])])]),_:1})]),_:1},8,["data","loading"]),!i.value&&l.value.length===0?(f(),w("div",ge,[r("div",_e,[t(A,{size:"48",color:"#c0c4cc"},{default:o(()=>[t(v(X))]),_:1}),e[7]||(e[7]=r("h3",null,"No categories found",-1)),p.value?(f(),w("p",fe," No categories match your search criteria. ")):(f(),w("p",ye," Get started by creating your first category. ")),p.value?M("",!0):(f(),z(c,{key:2,type:"primary",icon:v($),onClick:V},{default:o(()=>e[6]||(e[6]=[y(" Create Category ",-1)])),_:1,__:[6]},8,["icon"]))])])):M("",!0)]),t(te,{visible:g.value,category:_.value,onClose:s,onSuccess:n},null,8,["visible","category"])])}}}),we=I(ve,[["__scopeId","data-v-2aaf3f0a"]]);export{we as default};
